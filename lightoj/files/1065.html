<!DOCTYPE HTML>
<html>

<head>
	<title> Problem 1065</title>
	<meta name="description" content="website description" />
	<meta name="keywords" content="website keywords, website keywords" />
	<meta http-equiv="content-type" content="text/html; charset=windows-1252" />
	<link rel="stylesheet" type="text/css" href="../style/style.css" />
	<link rel="icon" type="image/png" href="style/favi.png">
	<script type="text/javascript" src="../scripts/shCore.js"></script>
	<script type="text/javascript" src="../scripts/shBrushCpp.js"></script>
	<link type="text/css" rel="stylesheet" href="../styles/shCoreDefault.css"/>
	<script type="text/javascript">SyntaxHighlighter.all();</script>
</head>

<body>
	<div id="main">
		<div id="header">
			<div id="logo">
				<h1>LightOJ Solutions</h1>
			</div>
			<div id="menubar">
				<ul id="menu">
					<li class="current"><a>1065</a></li>
					<li><a href="../">List of Problems</a></li>
					<li><a href="../tags">Search by Tags</a></li>
				</ul>
			</div>
		</div>
		<div id="site_content">
			<div id="sidebar_container">
				<img class="paperclip" src="../style/paperclip.png" alt="paperclip" />
				<div class="sidebar">
				<!-- insert your sidebar items here -->
				<h3>About Me</h3>
				<h3><a href="https://www.facebook.com/utk3995">Utkarsh Srivastava</a></h3><br/>
				<p> Student of IIIT Allahabad </p>
				<h5>Programmer | Developer | Reader<br/><br/></h5>
				</div>
			</div>
			<div id="content">
<h1><u>Question Code</u> : 1065</h1>
<h1><u>Problem Name</u> : <a href=http://lightoj.com/volume_showproblem.php?problem=1065 target="_blank" > Problem 1065 - Number Sequence</a></h1><br/>
<h3><u>Problem Tags</u> : 
<a href= ../tags/Matrix%20Exponentiation.html>Matrix Exponentiation</a><br/><br/>
<h3><u>Problem Statement</u> : </h3>

<p class=MsoNormal>Let's define another number sequence, given by the following 
function:</p> 

<p class=MsoNoSpacing><b>f(0) = a</b></p> 

<p class=MsoNoSpacing><b>f(1) = b</b></p> 

<p class=MsoNormal><b>f(n) = f(n-1) + f(n-2), n &gt; 1</b></p> 

<p class=MsoNormal>When <b>a = 0</b> and <b>b = 1</b>, this sequence gives the 
Fibonacci sequence. Changing the values of <b>a</b> and <b>b</b>, you can get 
many different sequences. Given the values of <b>a, b</b>, you have to find the 
last <b>m</b> digits of <b>f(n)</b>.</p> 

<br/><h3><u>Code</u> : </h3>
<pre class="brush: cpp;">
#include&lt;bits/stdc++.h&gt;
using namespace std;

#define ll long long int
#define pii pair&lt;int,int&gt;
#define pll pair&lt;ll,ll&gt;
#define vi vector&lt;int&gt;
#define pb push_back
#define mp make_pair
#define fr first
#define se second
//#define MOD 1000000007

int MOD;

// bits algorithm

inline int two(int n) { return 1 &lt;&lt; n; }
inline int test(int n, int b) { return (n&gt;&gt;b)&1; }
inline void set_bit(int & n, int b) { n |= two(b); }
inline void unset_bit(int & n, int b) { n &= ~two(b); }
inline int last_bit(int n) { return n & (-n); }
inline int ones(int n) { int res = 0; while(n && ++res) n-=n&(-n); return res; }

#define N 3

void mul(ll a[N][N],ll b[N][N])
{
    ll d[N][N]={};
    for(int i=0;i&lt;N;i++)
        for(int j=0;j&lt;N;j++)
            for(int k=0;k&lt;N;k++)
                d[i][j]=(d[i][j]+(a[i][k]*b[k][j])%MOD)%MOD;
    for(int i=0;i&lt;N;i++)
        for(int j=0;j&lt;N;j++)
            a[i][j]=d[i][j];
}

ll matrixExpo(int n,ll a,ll b)
{
    ll mat[N][N] = {{1,1,0},{1,0,0},{0,1,0}};
    ll ans[N][N] = {{1,1,0},{1,0,0},{0,1,0}};
    if (n==0) return a;
    if (n==1) return b;
    if (n==2) return a+b;
    n=n-2;
    while (n){
        if (n%2)
            mul(ans,mat);
        mul(mat,mat);
        n=n/2;
    }
    return ((ans[1][0]*(a+b)%MOD) + (ans[1][1]*(b)%MOD) + (ans[1][2]*(a)%MOD))%MOD;
}



int main ()
{
	//freopen("input.txt","r",stdin);
	ios_base::sync_with_stdio(false);
    int t;
    cin&gt;&gt;t;
    int cas=1;
    while (t--){
        cout&lt;&lt;"Case "&lt;&lt;cas++&lt;&lt;": ";
        ll a,b,n,m;
        cin&gt;&gt;a&gt;&gt;b&gt;&gt;n&gt;&gt;m;
        MOD = pow(10,m);
        cout&lt;&lt;matrixExpo(n,a,b)&lt;&lt;endl;
    }
	return 0;
}

			</div>
		</div>
		<div id="footer">
			<p> Last Updated on : <a>Tue, 15 Aug 2017</a></p>
		</div>
	</div>
</body>
</html>
